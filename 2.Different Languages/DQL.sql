-- DATA QUERY/RETRIVAL LANGUAGE (DRL/DQL)

-- CREATE DATABASE IF NOT EXISTS ORG;
-- SHOW DATABASES;
-- USE ORG;

-- CREATE TABLE Worker
-- (
-- WORKER_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
-- FIRST_NAME CHAR(25),
-- LAST_NAME CHAR(25),
-- SALARY INT(15),
-- JOINING_DATA DATETIME,
-- DEPARTMENT CHAR(25)
-- );

-- INSERT INTO Worker(WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATA,DEPARTMENT) VALUES
-- (001,"Monika","Arora",100000,"14-02-20 09.00.00","HR"),
-- (002,"Niharika","Verma",80000,"14-06-11 09.00.00","Admin"),
-- (003,"Vishal","Singhal",300000,"14-02-20 09.00.00","HR"),
-- (004,"Amitabh","Singh",500000,"14-02-20 09.00.00","Admin"),
-- (005,"Vivek","Bhati",500000,"14-06-11 09.00.00","Admin"),
-- (006,"Vipul","Diwan",200000,"14-06-11 09.00.00","Account"),
-- (007,"Satish","Kumar",75000,"14-01-20 09.00.00","Account"),
-- (008,"Geetika","Chauhan",90000,"14-04-11 09.00.00","Admin");

SELECT * FROM WORKER;

-- CREATE TABLE Bonus(
-- WORKER_REF_ID INT,
-- BONUS_AMOUNT INT,
-- BONUS_DATE DATETIME,
-- FOREIGN KEY(WORKER_REF_ID) REFERENCES WORKER(WORKER_ID) ON DELETE CASCADE);


-- INSERT INTO Bonus (WORKER_REF_ID,BONUS_AMOUNT,BONUS_DATE) VALUES 
-- (001,5000,"16-02-20"),
-- (002,3000,"16-06-11"),
-- (003,4000,"16-02-20"),
-- (001,4500,"16-02-20"),
-- (002,3500,"16-06-11");


-- CREATE TABLE Title
-- (WORKER_REF_ID INT,
-- WORKER_TITLE CHAR(25)
-- ,AFFECTED_FROM DATETIME
-- ,FOREIGN KEY(WORKER_REF_ID)
--  REFERENCES Worker(WORKER_ID) 
--  ON DELETE CASCADE);
 
--  INSERT INTO Title
-- (WORKER_REF_ID,WORKER_TITLE,AFFECTED_FROM)
-- VALUES
-- (001,"Manager","2016-02-20 00:00:00"),
-- (002,"Executive","2016-06-11 00:00:00"),
-- (003,"Executive","2016-06-11 00:00:00"),
-- (004,"Manager","2016-06-11 00:00:00"),
-- (005,"Asst. Manager","2016-06-11 00:00:00"),
-- (006,"Executive","2016-06-11 00:00:00"),
-- (007,"Lead","2016-06-11 00:00:00"),
-- (008,"Lead","2016-06-11 00:00:00");



SELECT * FROM WORKER;

SELECT FIRST_NAME,SALARY FROM WORKER;

-- DUAL TABLE CONCEPT
SELECT 44+11;

SELECT NOW();

SELECT LOWER("RAM");
SELECT UPPER("ram");


SELECT * FROM WORKER WHERE SALARY > 80000;

SELECT * FROM WORKER WHERE DEPARTMENT = "HR";

-- SALARY BETWEEN 80K AND 3LAKH (BOTH THE RANGE ARE INCLUSIVE)
SELECT * FROM WORKER WHERE SALARY BETWEEN 80000 AND 300000;

-- REDUCE OR STATEMENTS USING IN KEYWORD

-- EXTRACT EMPLOYEES BELONGS TO HR AND ADMIN
SELECT * FROM WORKER WHERE DEPARTMENT = "HR" OR DEPARTMENT = "ADMIN";

-- EXTRACT EMPLOYEES BELONGS TO HR AND ADMIN AND ACCOUNT
SELECT * FROM WORKER WHERE DEPARTMENT = "HR" OR DEPARTMENT = "ADMIN" OR DEPARTMENT = "ACCOUNT";

-- REDUCTION USING IN KEYWORD
SELECT * FROM WORKER WHERE DEPARTMENT IN ("HR","ADMIN","ACCOUNT");

-- REDUCTION USING IN AND NOT KEYWORD
SELECT * FROM WORKER WHERE DEPARTMENT NOT IN ("HR","ADMIN");

-- CREATE TABLE TEMP
-- (
-- WORKER_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
-- FIRST_NAME CHAR(25),
-- LAST_NAME CHAR(25),
-- SALARY INT(15),
-- JOINING_DATA DATETIME,
-- DEPARTMENT CHAR(25)
-- );

-- INSERT INTO TEMP(WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATA,DEPARTMENT) VALUES
-- (001,"Monika"," ",100000,"14-02-20 09.00.00","HR"),
-- (002,"Niharika","",80000,"14-06-11 09.00.00","Admin"),
-- (003,"Vishal","Singhal",300000,"14-02-20 09.00.00","HR"),
-- (004,"Amitabh","",500000,"14-02-20 09.00.00","Admin");

-- INSERT INTO TEMP VALUES
-- (006,"Monika",null,100000,"14-02-20 09.00.00","HR");

SELECT * FROM TEMP WHERE LAST_NAME IS NULL;


-- WILD CARD % (BEFORE i INFINITE CHARACTER AFTER i INFINTE CHARACTER)
SELECT * FROM WORKER WHERE FIRST_NAME LIKE "%i%";

-- WILD CARD _ (BEFORE i ONE CHARACTER AFTER i INFINITE CHARACTER)
SELECT * FROM WORKER WHERE FIRST_NAME LIKE "_i%";


-- SORTING (ASCENDING) BY DEFAULT
SELECT * FROM WORKER ORDER BY SALARY;


-- SORTING (DESCENDING)
SELECT * FROM WORKER ORDER BY SALARY DESC;


-- DISTINCT VALUE
SELECT DISTINCT DEPARTMENT FROM WORKER;

-- DATA GROUPING
SELECT DEPARTMENT AS DEPARTMENT_LIST , 
COUNT(DEPARTMENT) AS NO_OF_EMPLOYEE 
FROM WORKER GROUP BY DEPARTMENT;

-- FIND AVERAGE SALARY OF EACH DEPARTMENT
SELECT DEPARTMENT AS DEPARTMENT_LIST , 
AVG(SALARY) AS AVERAGE_SALARY_PER_DEPARTMENT 
FROM WORKER GROUP BY DEPARTMENT;

-- FIND MINIMUM SALARY OF EACH DEPARTMENT
SELECT DEPARTMENT AS DEPARTMENT_LIST , 
MIN(SALARY) AS MINIMUM_SALARY_PER_DEPARTMENT 
FROM WORKER GROUP BY DEPARTMENT;

-- FIND MAXIMUM SALARY OF EACH DEPARTMENT
SELECT DEPARTMENT AS DEPARTMENT_LIST , 
MAX(SALARY) AS MAXIMUM_SALARY_PER_DEPARTMENT 
FROM WORKER GROUP BY DEPARTMENT;

-- FIND TOTAL SALARY OF EACH DEPARTMENT
SELECT DEPARTMENT AS DEPARTMENT_LIST , 
SUM(SALARY) AS TOTAL_SALARY_PER_DEPARTMENT 
FROM WORKER GROUP BY DEPARTMENT;

-- GROUP BY HAVING
SELECT DEPARTMENT AS DEPARTMENT_LIST , 
COUNT(DEPARTMENT) AS NO_OF_EMPLOYEE
FROM WORKER GROUP BY DEPARTMENT HAVING COUNT(DEPARTMENT)>2;

SELECT DEPARTMENT AS DEPARTMENT_LIST , 
COUNT(DEPARTMENT) AS NO_OF_EMPLOYEE
FROM WORKER GROUP BY DEPARTMENT HAVING COUNT(DEPARTMENT)>1;